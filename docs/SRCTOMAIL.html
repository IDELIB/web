<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MAI/400 SRCTOMAIL - IBMi(AS/400)用SMTPメール送信プログラム。SSL/TLS対応、SMTP認証、文字コード変換機能搭載。">
    <meta name="keywords" content="IBMi,AS/400,SMTP,メール送信,ILE-C,SSL,TLS,SRCTOMAIL,MAI/400">
    <meta name="author" content="Y.Ide">
    <title>MAI/400 SRCTOMAIL - IBMi SMTP メール送信プログラム</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Yu Gothic', 'Meiryo', sans-serif;
            line-height: 1.8;
            color: #333;
            background: #f5f5f5;
        }
        
        .header-banner {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .logo-section h1 {
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .version-badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .nav-menu {
            display: flex;
            gap: 20px;
        }
        
        .nav-menu a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .nav-menu a:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .container {
            max-width: 1200px;
            margin: 30px auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }
        
        .hero-section h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: white;
            border: none;
        }
        
        .hero-section p {
            font-size: 1.3em;
            opacity: 0.95;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .content {
            padding: 40px;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .info-box.warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }
        
        .info-box.success {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }
        
        h2 {
            color: #1e3c72;
            font-size: 2em;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #1e3c72;
        }
        
        h3 {
            color: #2a5298;
            font-size: 1.5em;
            margin: 30px 0 15px 0;
            padding-left: 15px;
            border-left: 5px solid #2a5298;
        }
        
        h4 {
            color: #555;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-top: 4px solid #667eea;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .feature-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .feature-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        th {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        tr:hover {
            background: #f7fafc;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        .code-block .comment {
            color: #68d391;
        }
        
        .code-block .keyword {
            color: #f687b3;
        }
        
        .download-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 40px;
            border-radius: 10px;
            margin: 30px 0;
            text-align: center;
        }
        
        .download-button {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 1.2em;
            font-weight: bold;
            margin: 10px;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .download-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }
        
        .badge-primary {
            background: #667eea;
            color: white;
        }
        
        .badge-success {
            background: #48bb78;
            color: white;
        }
        
        .badge-warning {
            background: #ed8936;
            color: white;
        }
        
        .badge-info {
            background: #4299e1;
            color: white;
        }
        
        .version-history {
            background: #fff5f5;
            border-left: 5px solid #fc8181;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .version-history h4 {
            color: #c53030;
        }
        
        ul, ol {
            margin: 15px 0 15px 30px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .note {
            background: #fef5e7;
            border-left: 5px solid #f39c12;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .note::before {
            content: "💡 ";
            font-size: 1.2em;
        }
        
        .warning {
            background: #fef5f5;
            border-left: 5px solid #e74c3c;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .warning::before {
            content: "⚠️ ";
            font-size: 1.2em;
        }
        
        footer {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 0;
        }
        
        footer a {
            color: #4299e1;
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }
        
        .toc {
            background: #f7fafc;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #e2e8f0;
        }
        
        .toc h3 {
            border: none;
            padding: 0;
            margin-bottom: 15px;
        }
        
        .toc ul {
            list-style: none;
            margin: 0;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .toc a:hover {
            color: #764ba2;
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-menu {
                flex-direction: column;
                width: 100%;
            }
            
            .nav-menu a {
                text-align: center;
            }
            
            .logo-section h1 {
                font-size: 1.8em;
            }
            
            .hero-section h2 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- ヘッダーバナー -->
    <div class="header-banner">
        <div class="header-content">
            <div class="logo-section">
                <h1>📧 MAI/400</h1>
                <span class="version-badge">Version 3.01</span>
            </div>
            <nav class="nav-menu">
                <a href="#overview">概要</a>
                <a href="#features">機能</a>
                <a href="#install">インストール</a>
                <a href="#usage">使用例</a>
                <a href="#support">サポート</a>
            </nav>
        </div>
    </div>

    <div class="container">
        <!-- ヒーローセクション -->
        <div class="hero-section">
            <h2>SRCTOMAIL</h2>
            <p>IBMi(AS/400)用 SMTP メール送信プログラム</p>
            <p style="margin-top: 20px; font-size: 1em;">ILE-C言語で実装された、SSL/TLS対応の高機能メール送信ツール</p>
        </div>
        
        <div class="content">
            <!-- お知らせ -->
            <div class="info-box success">
                <h4>✨ 最新情報</h4>
                <p><strong>Version 3.01</strong> をリリースしました！SSL/TLS接続の安定性が向上し、無効なサーバー証明書にも対応しました。</p>
            </div>
            
            <!-- 目次 -->
            <div class="toc">
                <h3>📑 目次</h3>
                <ul>
                    <li><a href="#overview">1. MAI/400 SRCTOMAIL とは</a></li>
                    <li><a href="#features">2. 主要機能</a></li>
                    <li><a href="#requirements">3. 動作環境</a></li>
                    <li><a href="#install">4. インストール方法</a></li>
                    <li><a href="#parameters">5. コマンドパラメータ</a></li>
                    <li><a href="#usage">6. 使用例</a></li>
                    <li><a href="#technical">7. 技術仕様</a></li>
                    <li><a href="#version">8. バージョン履歴</a></li>
                    <li><a href="#license">9. ライセンス</a></li>
                    <li><a href="#support">10. サポート</a></li>
                </ul>
            </div>
            
            <!-- 概要 -->
            <section id="overview">
                <h2>1. MAI/400 SRCTOMAIL とは</h2>
                
                <p><strong>MAI/400 SRCTOMAIL</strong> は、IBMi（AS/400）環境でソースファイルやデータベースファイルのメンバーを、SMTPプロトコルを使用してメール送信するためのプログラムです。</p>
                
                <p style="margin-top: 15px;">2000年の初版リリースから20年以上にわたり、多くの企業で利用されている実績のあるツールです。ILE-C言語で実装され、SSL/TLS暗号化通信、SMTP認証、文字コード変換、添付ファイル機能など、現代的なメール送信に必要な機能を完備しています。</p>
                
                <div class="feature-grid" style="margin-top: 30px;">
                    <div class="feature-card">
                        <div class="feature-icon">🔒</div>
                        <h4>セキュア通信</h4>
                        <p>SSL/TLS暗号化通信に対応。Port 465（SSL over SMTP）とPort 587（STARTTLS）をサポート。</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🔐</div>
                        <h4>SMTP認証</h4>
                        <p>PLAIN認証とLOGIN認証に対応。Base64エンコードによる安全な認証処理。</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🌏</div>
                        <h4>文字コード変換</h4>
                        <p>EBCDIC⇔ASCII、JIS、Shift-JIS、EUC等の文字コード変換に対応。</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">📎</div>
                        <h4>添付ファイル</h4>
                        <p>IFS上のファイルを最大300件まで添付可能。MIMEマルチパート形式で送信。</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">📧</div>
                        <h4>複数宛先</h4>
                        <p>To、Cc、Bccそれぞれ最大300件まで指定可能。</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🎌</div>
                        <h4>日本語対応</h4>
                        <p>RFC1522準拠のBase64エンコードで日本語ヘッダーに完全対応。</p>
                    </div>
                </div>
            </section>
            
            <!-- 主要機能 -->
            <section id="features">
                <h2>2. 主要機能</h2>
                
                <h3>2.1 SSL/TLS暗号化通信</h3>
                <p>GSKit APIを使用した暗号化通信に対応しています。</p>
                <ul>
                    <li><strong>Port 465:</strong> SSL over SMTP（接続開始時からSSL暗号化）</li>
                    <li><strong>Port 587:</strong> STARTTLS（平文で接続後、STARTTLSコマンドでTLS化）</li>
                    <li><strong>証明書管理:</strong> DCM（Digital Certificate Manager）との統合</li>
                    <li><strong>自動登録:</strong> アプリケーションIDの自動登録・解除機能</li>
                </ul>
                
                <div class="note">
                    SSL/TLS接続を使用する場合は、IBMiにDCM（5770SS1 Option 34）が導入されている必要があります。
                </div>
                
                <h3>2.2 SMTP認証</h3>
                <p>以下の認証方式に対応しています:</p>
                <ul>
                    <li><strong>PLAIN認証:</strong> ユーザー名とパスワードをBase64エンコードして送信</li>
                    <li><strong>LOGIN認証:</strong> ユーザー名とパスワードを個別にBase64エンコードして送信</li>
                </ul>
                <p>認証情報はEBCDICからASCIIに変換後、Base64エンコードされます。パスワードは DSPINPUT(*NO) により入力時に非表示となり、ジョブログにも記録されません。</p>
                
                <h3>2.3 文字コード変換</h3>
                <p>iconv APIを使用した柔軟な文字コード変換:</p>
                <ul>
                    <li><strong>入力CCSID:</strong> 5035（日本語EBCDIC）、5026（カタカナEBCDIC）等</li>
                    <li><strong>出力CCSID:</strong> 5054（JIS）、932（Shift-JIS）、943（CP943）、5050（EUC）</li>
                    <li><strong>カタカナ処理:</strong> 半角カタカナ→全角カタカナ変換（濁点・半濁点の合成処理含む）</li>
                    <li><strong>SO/SI制御:</strong> シフトイン/アウト文字の適切な処理</li>
                </ul>
                
                <h3>2.4 添付ファイル機能</h3>
                <ul>
                    <li>IFS上のファイルを最大300件まで添付可能</li>
                    <li>MIMEマルチパート形式（multipart/mixed）で送信</li>
                    <li>Base64エンコードによるバイナリファイル対応</li>
                    <li>Content-Type: application/octet-stream</li>
                </ul>
                
                <h3>2.5 デバッグ機能</h3>
                <p>DEBUG(*YES) パラメータにより、トラブルシューティング用の詳細情報を出力できます。</p>
                <ul>
                    <li>SMTPサーバーとの全通信内容をジョブログに記録</li>
                    <li>送受信されるコマンド（EHLO, MAIL FROM, RCPT TO, DATA等）とレスポンスを確認</li>
                    <li>認証プロセスの詳細を可視化</li>
                    <li>エラー発生時の原因特定に有用</li>
                </ul>
                
                <div class="note">
                    開発・テスト環境では DEBUG(*YES) を使用し、本番環境では DEBUG(*NO) を使用することを推奨します。
                </div>
            </section>
            
            <!-- 動作環境 -->
            <section id="requirements">
                <h2>3. 動作環境</h2>
                
                <table>
                    <tr>
                        <th>項目</th>
                        <th>要件</th>
                    </tr>
                    <tr>
                        <td>OS</td>
                        <td>IBM i V7R1M0以降</td>
                    </tr>
                    <tr>
                        <td>コンパイラー</td>
                        <td>ILE C/C++ (5770WDS Option 51)</td>
                    </tr>
                    <tr>
                        <td>SSL/TLS使用時</td>
                        <td>Digital Certificate Manager (5770SS1 Option 34)</td>
                    </tr>
                    <tr>
                        <td>ネットワーク</td>
                        <td>TCP/IP接続可能な環境</td>
                    </tr>
                    <tr>
                        <td>ディスク容量</td>
                        <td>約5MB（プログラムオブジェクト含む）</td>
                    </tr>
                </table>
                
                <h3>3.1 制限事項</h3>
                <ul>
                    <li>宛先（To/Cc/Bcc）: 各最大300件</li>
                    <li>添付ファイル: 最大300件</li>
                    <li>件名: 最大128文字</li>
                    <li>メールアドレス: 最大80文字</li>
                    <li>添付ファイルパス: 最大512文字</li>
                    <li>対応SMTP認証: PLAIN、LOGIN のみ（CRAM-MD5、DIGEST-MD5は未対応）</li>
                </ul>
            </section>
            
            <!-- ダウンロード -->
            <!-- インストール方法 -->
            <section id="install">
                <h2>4. セットアップについて</h2>
                
                <p>ファイル<strong>MAIV300.ZIP</strong>を解凍するとSAVF形式のファイルが作成されます。<br>
                SAVF形式ファイル<strong>MAIV300.SAVF</strong>をftpなどでアップロードし、RSTLIBコマンドで復元してください。</p>
                
                <h3>4.1 FTPによるアップロード手順例</h3>
                <div class="code-block">
<span class="comment">/* FTPでSAVFファイルをアップロード */</span>
<span class="keyword">ftp</span> "IBM i(AS/400)のホスト名"
<span class="keyword">quote site namefmt 1</span>
<span class="keyword">bin</span>
<span class="keyword">put</span> MAIV300.SAVF
<span class="keyword">quit</span>
                </div>
                
                <h3>4.2 IBM i での復元例</h3>
                <div class="code-block">
<span class="comment">/* ライブラリの復元 */</span>
<span class="keyword">RSTLIB</span> SAVLIB(MAI) DEV(*SAVF) SAVF(MAIV300)
                </div>
                
                <div class="info-box">
                    <h4>📌 重要事項</h4>
                    <p>本ソフトウェアは<strong>2026年12月31日までの使用期限付きの試用版</strong>となります。</p>
                </div>
                
                <h3>4.3 SSL/TLS使用時の追加設定</h3>
                <p>SMTPS(SSL/TLS)を使用するには<strong>*SYSTEM証明書ストア</strong>が必要ですので、ディジタル証明書マネージャー(DCM)を用いて作成してください。</p>
                
                <p style="margin-top: 15px;">メールサーバーが使用しているCA証明書などをIBM iにインポートが必要な場合があります。<br>
                以下のエラーがログされた場合には、CA証明書をインポートしてください。</p>
                
                <div class="warning">
                    「gsk_asecure_soc_init errno=0 GSK-ERROR=6000  証明書がトラステッド認証局によって署名されていません。」
                </div>
                
                <div class="note">
                    <strong>ご参考:</strong> CA証明書をインポートするユーティリティ「QMGTOOLS GETSSL Utility」が利用できます。<br>
                    <ul style="margin-top: 10px;">
                        <li><a href="https://www.ibm.com/support/pages/qmgtools-getssl-utility" target="_blank">QMGTOOLS GETSSL Utility</a></li>
                        <li><a href="https://www.ibm.com/support/pages/mustgather-how-obtain-and-install-qmgtools-and-keep-it-current" target="_blank">QMGTOOLSの入手</a></li>
                    </ul>
                </div>
            </section>
            
            <!-- コマンドパラメータ -->
            <section id="parameters">
                <h2>5. コマンドパラメータ</h2>
                
                <p>SRCTOMAILコマンドは、21個のパラメータを持ちます。</p>
                
                <table>
                    <tr>
                        <th>パラメータ</th>
                        <th>説明</th>
                        <th>必須</th>
                        <th>デフォルト</th>
                    </tr>
                    <tr>
                        <td><strong>TO</strong></td>
                        <td>宛先メールアドレス（最大300件）</td>
                        <td>✓</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>FROM</strong></td>
                        <td>送信元メールアドレス</td>
                        <td>✓</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>SERVER</strong></td>
                        <td>メールサーバー（ホスト名またはIPアドレス）</td>
                        <td>✓</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>FILE</strong></td>
                        <td>ソースファイル（ライブラリ/ファイル名）</td>
                        <td>✓</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>MBR</strong></td>
                        <td>メンバー名</td>
                        <td></td>
                        <td>*FIRST</td>
                    </tr>
                    <tr>
                        <td><strong>SUBJECT</strong></td>
                        <td>件名（128文字まで）</td>
                        <td></td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>FROMCCSID</strong></td>
                        <td>ファイルのCCSID</td>
                        <td></td>
                        <td>5035</td>
                    </tr>
                    <tr>
                        <td><strong>TOCCSID</strong></td>
                        <td>メール本文のCCSID</td>
                        <td></td>
                        <td>*JIS (5054)</td>
                    </tr>
                    <tr>
                        <td><strong>KATAKANA</strong></td>
                        <td>カタカナ処理（*DBCS/*NONE）</td>
                        <td></td>
                        <td>*DBCS</td>
                    </tr>
                    <tr>
                        <td><strong>SFTBLANK</strong></td>
                        <td>シフト文字のブランク置換</td>
                        <td></td>
                        <td>*YES</td>
                    </tr>
                    <tr>
                        <td><strong>DEBUG</strong></td>
                        <td>デバッグモード</td>
                        <td></td>
                        <td>*NO</td>
                    </tr>
                    <tr>
                        <td><strong>ATTACH</strong></td>
                        <td>添付ファイル（IFSパス、最大300件）</td>
                        <td></td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>CC</strong></td>
                        <td>CCメールアドレス（最大300件）</td>
                        <td></td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>BCC</strong></td>
                        <td>BCCメールアドレス（最大300件）</td>
                        <td></td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>REPLYTO</strong></td>
                        <td>Reply-Toアドレス</td>
                        <td></td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>SMTPPORT</strong></td>
                        <td>ポート番号（*SMTP/25, *SMTPS/587, *SSL/465）</td>
                        <td></td>
                        <td>25</td>
                    </tr>
                    <tr>
                        <td><strong>SMTPUSR</strong></td>
                        <td>SMTP認証ユーザー名</td>
                        <td></td>
                        <td>*NONE</td>
                    </tr>
                    <tr>
                        <td><strong>SMTPPWD</strong></td>
                        <td>SMTP認証パスワード</td>
                        <td></td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>SSL</strong></td>
                        <td>SSL/TLS使用フラグ</td>
                        <td></td>
                        <td>*NO</td>
                    </tr>
                    <tr>
                        <td><strong>NOCNV</strong></td>
                        <td>ヘッダー漢字エンコードなし</td>
                        <td></td>
                        <td>*NO</td>
                    </tr>
                    <tr>
                        <td><strong>GSKAPPID</strong></td>
                        <td>DCM APPLICATION ID</td>
                        <td></td>
                        <td>MAI_SMTPS_CLIENT</td>
                    </tr>
                </table>
                
                <h3>5.1 メールアドレスの形式</h3>
                <p>以下の3つの形式がサポートされています:</p>
                
                <div class="code-block">
<span class="comment">// 形式1: メールアドレスのみ</span>
'user@example.com'

<span class="comment">// 形式2: 名前 <メールアドレス></span>
'山田太郎 <user@example.com>'

<span class="comment">// 形式3: メールアドレス(名前)</span>
'user@example.com(山田太郎)'
                </div>
                
                <div class="note">
                    日本語を含む名前部分は、RFC1522に従ってBase64エンコードされます。
                </div>
            </section>
            
            <!-- 使用例 -->
            <section id="usage">
                <h2>6. 使用例</h2>
                
                <h3>6.1 基本的な使用例</h3>
                <div class="code-block">
<span class="comment">/* シンプルなメール送信 */</span>
<span class="keyword">SRCTOMAIL</span> TO('user@example.com') +
          FROM('sender@example.com') +
          SERVER('smtp.example.com') +
          FILE(MYLIB/QRPGLESRC) +
          MBR(MYPGM) +
          SUBJECT('プログラムソース送付')
                </div>
                
                <h3>6.2 SSL/TLS + SMTP認証（Gmail）</h3>
                <div class="code-block">
<span class="comment">/* Gmailを使用したセキュアな送信 */</span>
<span class="keyword">SRCTOMAIL</span> TO('user@example.com') +
          FROM('myaccount@gmail.com') +
          SERVER('smtp.gmail.com') +
          FILE(MYLIB/QRPGLESRC) +
          MBR(MYPGM) +
          SUBJECT('重要なソースコード') +
          SMTPPORT(*SMTPS) +
          SMTPUSR('myaccount@gmail.com') +
          SMTPPWD('app-password') +
          SSL(*YES)
                </div>
                
                <div class="note">
                    Gmailを使用する場合は、アプリパスワードの生成が必要です。通常のパスワードは使用できません。
                </div>
                
                <h3>6.3 複数宛先 + 添付ファイル</h3>
                <div class="code-block">
<span class="comment">/* 複数宛先と添付ファイル */</span>
<span class="keyword">SRCTOMAIL</span> TO('user1@example.com' +
             'user2@example.com' +
             'user3@example.com') +
          CC('manager@example.com') +
          BCC('archive@example.com') +
          FROM('sender@example.com') +
          SERVER('smtp.example.com') +
          FILE(MYLIB/QRPGLESRC) +
          MBR(MYPGM) +
          SUBJECT('プロジェクト資料') +
          ATTACH('/home/user/document.pdf' +
                 '/home/user/image.jpg') +
          REPLYTO('support@example.com')
                </div>
                
                <h3>6.4 文字コード変換（Shift-JIS）</h3>
                <div class="code-block">
<span class="comment">/* Shift-JISで送信 */</span>
<span class="keyword">SRCTOMAIL</span> TO('user@example.com') +
          FROM('sender@example.com') +
          SERVER('smtp.example.com') +
          FILE(MYLIB/QRPGLESRC) +
          MBR(MYPGM) +
          SUBJECT('Shift-JIS形式') +
          FROMCCSID(5035) +
          TOCCSID(*SJIS) +
          KATAKANA(*DBCS)
                </div>
                
                <h3>6.5 デバッグモード</h3>
                <div class="code-block">
<span class="comment">/* デバッグ情報をJOBLOGに出力 */</span>
<span class="keyword">SRCTOMAIL</span> TO('user@example.com') +
          FROM('sender@example.com') +
          SERVER('smtp.example.com') +
          FILE(MYLIB/QRPGLESRC) +
          MBR(MYPGM) +
          SUBJECT('テスト送信') +
          DEBUG(*YES)
                </div>
                
                <h3>6.6 Office 365 / Outlook.com</h3>
                <div class="code-block">
<span class="comment">/* Office 365を使用 */</span>
<span class="keyword">SRCTOMAIL</span> TO('user@example.com') +
          FROM('myaccount@outlook.com') +
          SERVER('smtp.office365.com') +
          FILE(MYLIB/QRPGLESRC) +
          MBR(MYPGM) +
          SUBJECT('ドキュメント送付') +
          SMTPPORT(*SMTPS) +
          SMTPUSR('myaccount@outlook.com') +
          SMTPPWD('password') +
          SSL(*YES)
                </div>
            </section>
            
            <!-- 技術仕様 -->
            <section id="technical">
                <h2>7. 技術仕様</h2>
                
                <h3>7.1 対応プロトコル・規格</h3>
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>SMTP</h4>
                        <p>RFC 5321準拠のSMTPプロトコル実装</p>
                        <span class="badge badge-primary">RFC 5321</span>
                    </div>
                    <div class="feature-card">
                        <h4>MIME</h4>
                        <p>RFC 2045/2046準拠のMIME形式</p>
                        <span class="badge badge-primary">RFC 2045</span>
                        <span class="badge badge-primary">RFC 2046</span>
                    </div>
                    <div class="feature-card">
                        <h4>エンコード</h4>
                        <p>RFC 1522準拠のヘッダーエンコード</p>
                        <span class="badge badge-primary">RFC 1522</span>
                    </div>
                    <div class="feature-card">
                        <h4>SSL/TLS</h4>
                        <p>GSKit APIによるSSL/TLS実装</p>
                        <span class="badge badge-success">GSKit</span>
                    </div>
                </div>
                
                <h3>7.2 プログラム構成</h3>
                <ul>
                    <li><strong>SMTPSRVS (*SRVPGM):</strong> SMTPサービスプログラム（2,593行）
                        <ul>
                            <li>28個の関数をエクスポート</li>
                            <li>ソケット通信、SSL/TLS、文字コード変換等の機能を提供</li>
                        </ul>
                    </li>
                    <li><strong>SRCTOMAIL (*PGM):</strong> メインプログラム
                        <ul>
                            <li>SMTPSRVSサービスプログラムを使用</li>
                            <li>ファイル読み込み、パラメータ処理、エラーハンドリング</li>
                        </ul>
                    </li>
                    <li><strong>SRCTOMAIL (*CMD):</strong> CLコマンド
                        <ul>
                            <li>21個のパラメータ定義</li>
                            <li>ヘルプパネルグループと連携</li>
                        </ul>
                    </li>
                </ul>
                
                <h3>7.3 セキュリティ考慮事項</h3>
                <div class="info-box">
                    <h4>セキュリティに関する推奨事項:</h4>
                    <ul>
                        <li>SMTP認証のパスワードは DSPINPUT(*NO) により入力時に非表示となり、ジョブログにも記録されません</li>
                        <li>本番環境では、SSL/TLS接続の使用をお勧めします</li>
                        <li>SSL/TLS使用時は、DCMで適切な証明書管理を行うことを推奨します</li>
                        <li>プログラムオブジェクトの所有者とアクセス権限を適切に設定することをお勧めします</li>
                        <li>パスワードはメモリ上で一時的に保持されますが、プログラム終了時にクリアされます</li>
                        <li><strong>DEBUG(*YES)</strong> を使用すると、SMTPサーバーとの通信内容がジョブログに出力されます。本番環境では DEBUG(*NO) の使用を推奨します</li>
                    </ul>
                </div>
                
                <h3>7.4 パフォーマンス</h3>
                <ul>
                    <li>ソケット通信にTCP_NODELAYオプションを使用し、遅延を最小化</li>
                    <li>非ブロッキングモードでの接続処理（3秒タイムアウト）</li>
                    <li>SSL/TLSハンドシェイクのリトライ機能（最大3回）</li>
                    <li>効率的な文字コード変換（iconvライブラリ使用）</li>
                </ul>
            </section>
            
            <!-- バージョン履歴 -->
            <section id="version">
                <h2>8. バージョン履歴</h2>
                
                <div class="version-history">
                    <h4>Version 3.01 (2023年)</h4>
                    <ul>
                        <li>GSK_CLIENT_AUTH_PASSHTRUをTRUEに設定</li>
                        <li>無効なサーバー証明書も許容する設定追加</li>
                    </ul>
                </div>
                
                <div class="version-history">
                    <h4>Version 3.00 (2023年)</h4>
                    <ul>
                        <li>ライセンスキー機能追加</li>
                        <li>DCM API統合（SMTPRegDCM関数）</li>
                        <li>DCM LPPインストール確認機能</li>
                        <li>アプリケーションIDの自動登録/解除</li>
                        <li>SSL/TLS接続方式の整理</li>
                        <li>X-Mailer: MAI/400 Version 3.00</li>
                    </ul>
                </div>
                
                <div class="version-history">
                    <h4>Version 2.30 (2020年)</h4>
                    <ul>
                        <li>TLS対応（GSKIT使用）</li>
                        <li>SSL/TLS暗号化通信機能追加</li>
                    </ul>
                </div>
                
                <div class="version-history">
                    <h4>Version 2.17 (2018年)</h4>
                    <ul>
                        <li>SMTPValidAddr関数追加（メールアドレス検証）</li>
                        <li>DspEXTMSG関数追加</li>
                    </ul>
                </div>
                
                <div class="version-history">
                    <h4>Version 2.09 (2010年)</h4>
                    <ul>
                        <li>SMTP-AUTH対応</li>
                    </ul>
                </div>
                
                <div class="version-history">
                    <h4>Version 2.00 (2009年6月15日)</h4>
                    <ul>
                        <li>サービスプログラム化</li>
                        <li>SMTPSRVS.c作成</li>
                    </ul>
                </div>
                
                <div class="version-history">
                    <h4>Version 1.00 (2000年2月18日)</h4>
                    <ul>
                        <li>初版リリース</li>
                        <li>基本的なSMTPメール送信機能</li>
                    </ul>
                </div>
            </section>
            
            <!-- ライセンス -->
            <section id="license">
                <h2>9. ライセンス</h2>
                
                <div class="info-box">
                    <h4>📜 ライセンス情報</h4>
                    <p><strong>MAI/400 SRCTOMAIL</strong> は、個人・商用利用ともに無料でご利用いただけます。</p>
                    <p style="margin-top: 15px;">ただし、以下の点にご注意ください:</p>
                    <ul>
                        <li>本ソフトウェアは「現状のまま」提供されます</li>
                        <li>作者は本ソフトウェアの使用により生じたいかなる損害についても責任を負いません</li>
                        <li>ソースコードの改変・再配布は自由ですが、著作権表示は保持してください</li>
                        <li>商用製品への組み込みについては、事前にご相談ください</li>
                    </ul>
                </div>
                
                <h3>9.1 著作権</h3>
                <p>Copyright © 2000-2023 Y.Ide All Rights Reserved.</p>
            </section>
            
            <!-- サポート -->
            <section id="support">
                <h2>10. サポート</h2>
                
                <h3>10.1 お問い合わせ</h3>
                <p>MAI/400 SRCTOMAILに関するご質問、バグレポート、機能要望等は、以下の方法でお問い合わせください。</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">💬</div>
                        <h4>GitHub Issues</h4>
                        <p>バグレポートや機能要望は、GitHubのIssuesをご利用ください。</p>
                        <p style="margin-top: 10px;"><a href="https://github.com/IDELIB/IBM_Bob/issues" target="_blank">Issues を開く</a></p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">📧</div>
                        <h4>メール</h4>
                        <p>個別のご相談は、メールでお問い合わせください。</p>
                        <p style="margin-top: 10px;">Email: <a href="mailto:ide@sh.rim.or.jp">ide@sh.rim.or.jp</a></p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🌐</div>
                        <h4>Webサイト</h4>
                        <p>最新情報は公式Webサイトをご確認ください。</p>
                        <p style="margin-top: 10px;"><a href="http://www.sh.rim.or.jp/~ide/mai/" target="_blank">公式サイト</a></p>
                    </div>
                </div>
                
                <h3>10.2 よくある質問（FAQ）</h3>
                
                <h4>Q1: Gmailで送信できません</h4>
                <p><strong>A:</strong> Gmailを使用する場合は、以下の点を確認してください:</p>
                <ul>
                    <li>2段階認証を有効にし、アプリパスワードを生成してください</li>
                    <li>SMTPPORT(*SMTPS) と SSL(*YES) を指定してください</li>
                    <li>SERVER('smtp.gmail.com') を使用してください</li>
                </ul>
                
                <h4>Q2: SSL/TLS接続でエラーが発生します</h4>
                <p><strong>A:</strong> 以下を確認してください:</p>
                <ul>
                    <li>DCM（5770SS1 Option 34）が導入されているか</li>
                    <li>*SYSTEM証明書ストアが作成されているか</li>
                    <li>必要なCA証明書がインポートされているか</li>
                </ul>
                
                <h4>Q3: 日本語が文字化けします</h4>
                <p><strong>A:</strong> FROMCCSID と TOCCSID パラメータを確認してください。通常は以下の設定を推奨します:</p>
                <ul>
                    <li>FROMCCSID(5035) - ファイルのCCSID</li>
                    <li>TOCCSID(*JIS) - メール本文のCCSID</li>
                    <li>KATAKANA(*DBCS) - カタカナを全角に変換</li>
                </ul>
                
                <h4>Q4: 添付ファイルが送信できません</h4>
                <p><strong>A:</strong> 以下を確認してください:</p>
                <ul>
                    <li>IFSパスが正しいか（/home/user/file.pdf 等）</li>
                    <li>ファイルへのアクセス権限があるか</li>
                    <li>ファイルサイズが大きすぎないか（メールサーバーの制限を確認）</li>
                </ul>
                
                <h3>11.3 トラブルシューティング</h3>
                <p>問題が発生した場合は、まず DEBUG(*YES) を指定して実行し、ジョブログを確認してください。</p>
                
                <div class="code-block">
<span class="comment">/* デバッグモードで実行 */</span>
<span class="keyword">SRCTOMAIL</span> ... DEBUG(*YES)

<span class="comment">/* ジョブログの確認 */</span>
<span class="keyword">DSPJOBLOG</span>
                </div>
            </section>
            
            <!-- まとめ -->
            <section>
                <h2>11. まとめ</h2>
                
                <p><strong>MAI/400 SRCTOMAIL</strong>は、20年以上の開発・改良の歴史を持つ、成熟したメール送信プログラムです。</p>
                
                <p style="margin-top: 15px;">IBMi環境特有の文字コード処理、SSL/TLS暗号化通信、SMTP認証など、現代的なメール送信に必要な機能を完備しており、企業システムでの実用に耐える品質を備えています。</p>
                
                <p style="margin-top: 15px;">ソースファイルの送信だけでなく、添付ファイル機能により、様々なドキュメントの配信にも活用できます。</p>
                
                <h3>主な利点</h3>
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>✅ 高い互換性</h4>
                        <p>V7R1M0以降のIBMiで動作。長期間のバージョンアップに対応。</p>
                    </div>
                    <div class="feature-card">
                        <h4>✅ セキュア</h4>
                        <p>SSL/TLS暗号化とSMTP認証により、安全な通信を実現。</p>
                    </div>
                    <div class="feature-card">
                        <h4>✅ 柔軟性</h4>
                        <p>多様な文字コード、複数宛先、添付ファイルに対応。</p>
                    </div>
                    <div class="feature-card">
                        <h4>✅ 使いやすさ</h4>
                        <p>IBMi標準のコマンド形式で、直感的に使用可能。</p>
                    </div>
                    <div class="feature-card">
                        <h4>✅ 拡張性</h4>
                        <p>サービスプログラム化により、他のプログラムから呼び出し可能。</p>
                    </div>
                    <div class="feature-card">
                        <h4>✅ 保守性</h4>
                        <p>詳細なヘルプとデバッグ機能により、トラブルシューティングが容易。</p>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <!-- フッター -->
    <footer>
        <p><strong>MAI/400 SRCTOMAIL</strong> - IBMi SMTP Mail Sender</p>
        <p style="margin-top: 10px;">Version 3.01 | Author: Y.Ide | 2000-2023</p>
        <p style="margin-top: 20px;">
            <span class="badge badge-info">ILE-C</span>
            <span class="badge badge-success">SSL/TLS</span>
            <span class="badge badge-warning">SMTP-AUTH</span>
            <span class="badge badge-primary">MIME</span>
        </p>