<HTML>
<HEAD>
<TITLE>CLab-付録</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<CENTER>
<TABLE BORDER=0" WIDTH="600" BGCOLOR="#FEFBDA">
<TR><TD>

<TABLE BORDER=0" WIDTH="600">
<TR>
<TD BGCOLOR="#800040" WIDTH="10%" ALIGN="CENTER">
<FONT SIZE=2 COLOR="#FFFFFF"><B>付録</B></FONT>
</TD>

<TD BGCOLOR="000000" WIDTH="75%">
<FONT SIZE=4 COLOR ="#FFFFFF"><B>　ＣからＯＰＭ−ＲＰＧを呼び出す</B></FONT>
<BR>
</TD>
<TD BGCOLOR="000000" WIDTH="15%">
<FONT SIZE=1 COLOR ="#FFFFFF"><B>
RPGプログラマーの為のＣ言語講座
</B></FONT>
</TD>
</TR>
</TABLE>
</TD></TR>

<TR><TD ALIGN="CENTER">
<TABLE BORDER=0" WIDTH="570">
<TR>
<TD><FONT SIZE=2>

<H3>ＣからＯＰＭ−ＲＰＧを呼び出す場合の、サンプルコードです。</H3>

<H4>必要なのは、#pragma linkage(プログラム名,OS)と関数のプロトタイプ宣言です。</H4>

<P>ＲＰＧを呼び出すＰＧＭ PROG3C
<CENTER>
<TABLE BORDER=1 WIDTH="550" BGCOLOR="#E0FFDF" >
<TR>
<TD>
<PRE>
/*---------------------------------------------------------------*/
/* PROGRAM-ID  : PROG3C                                          */
/* REMARKS     : RPGを呼びたすＰＧＭ                           */
/* AUTHOR      : Y.Ide                                           */
/* DATE-WRITEN : 1999/8/15                                       */
/* VERSION     : 01.00 ORIGINAL                                  */
/*---------------------------------------------------------------*/
/* ＲＰＧを呼び出すプログラム　　　　　　　　　                */
/* ポインター渡しで全部のパラメーターを定義する                */

#include&LT;stdio.h&GT;

<FONT COLOR="#ff0080">#pragma linkage(PROG3R,OS)</FONT>

<FONT COLOR="#ff0080">/*関数プロトタイプ宣言*/
void PROG3R(char *, int *);
</FONT>
int  main(int argc, char *argv[]){
  char *p1 = "1234567890";
  int  p2  = 123 ;

  printf("P1 = %s \n",p1);
  printf("P2 = %d \n",p2);

  PROG3R(p1,&p2);

  return 0 ;

}
</PRE>
</TD>
</TR>
</TABLE>
</CENTER>

<P>Ｃから呼び出されるＰＧＭ PROG3R
<CENTER>
<TABLE BORDER=1 WIDTH="550" BGCOLOR="#E0FFDF" >
<TR>
<TD>
<PRE>
     H            Y/                                    1
     H*---------------------------------------------------------------*
     H* PROGRAM-ID    :    PROG3R                                     *
     H* REMARKS       :   Ｃから呼び出されるプログラム　　          *
     H* AUTHOR        :    Y.IDE                                      *
     H* DATE-WRITEN   :    1999/8/15                                  *
     H* VERSION       :    01.00 ORIGINAL                             *
     H*---------------------------------------------------------------*
     I            DS
     I                                        1   4 P2A
     I                                    B   1   40P2B
     C           *ENTRY    PLIST
     C                     PARM           P1     10
     C                     PARM           P2      4
     C*
     C                     Z-ADD0         P2B
     C                     MOVE P2        P2A
     C*
     C           P1        DSPLY
     C           P2B       DSPLY
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
</PRE>
</TD>
</TR>
</TABLE>
</CENTER>

</FONT>
</TD></TR>
</TABLE>

<HR>
</TD></TR>
</TABLE>

</BODY>
</HTML>